<script type="text/javascript">
  window.LandbotConfig = {
    "staticUrl": "https://storage.googleapis.com/static.yexir.com/",
    "serverUrl": "https://daisho.yexir.com",
    "channelToken": "H-92-CJ5AGAH0FTGYDQSK",
    "brandID": 251,
    "brandName": "Landbot.io",
    "logo": "https://storage.googleapis.com/media.yexir.com/receive/10145/W.png",
    "tagline": "Turn a landing page into a chatbot",
    "title": "Turn a landing page into a chatbot | Landbot",
    "description": "Landbot.io is a tool to easily create conversational experiences in substitution of landing pages. No coding required!",
    "apiKey": "AIzaSyDsVTr4OpOV45cfIXxcV1UvAEQ6JjnMbZU",
    "authDomain": "daisho-yexir.firebaseapp.com",
    "databaseURL": "https://daisho-yexir.firebaseio.com",
    "storageBucket": "daisho-yexir.appspot.com",
    "background-video": true,
    "videoname": "video",
    'custom': {
      "background-type": "\"gradient\"",
      "gradient-from": "#ff0051",
      "gradient-to": "#ffb389",
      "contrast": "white",
      "staticUrl": "\"https://storage.googleapis.com/static.yexir.com/\""
    },
    "onloadLivechatJS": "dynamicWelcome()",
    "messageLimit": 0
  };

  window.STORAGE_KEY = 'helloumi-webchat-customer-' + window.LandbotConfig.channelToken;
  window.CST_BACKUP = localStorage.getItem( window.STORAGE_KEY );

  function loadHelloumiLandbot() {
    HULandbot = new Landbot(window.LandbotConfig);
    HULandbot.createLandbot();
  }

  function dynamicWelcome() {
    if ( localStorage.getItem(window.STORAGE_KEY) ) {
      localStorage.removeItem(window.STORAGE_KEY)
    }

    renderHelloumiLiveChat( false, loadStaticWelcome);
    // document.getElementById('hu-webchat-loader').style.setProperty('display', 'none', 'important');
  }

  function loadStaticWelcome() {
    var firstTimeBot = {
      "name": "Welcome",
      "init": "welcome_0",
      "status": {
        "welcome_0": {
          "text": "Hi there! Welcome to the building area of Landbot üíÉü§ñüèÉ ",
          "next": "welcome_1",
          "extra": {
            "hide_textbox": true
          }
        },
        "welcome_1": {
          "text": "I need your email to give you access to the app once you‚Äôre done",
          "next": "welcome_2",
          "extra": {
            "hide_textbox": true
          }
        },
        "welcome_2": {
          "text": "Type it below, please ü§ì",
          "next": false,
          "extra": {
            "hide_textbox": false
          }
        }
      }
    };
    var welcomeBackBot = {
      "name": "Welcome",
      "init": "welcome_0",
      "status": {
        "welcome_0": {
          "text": "Welcome back!",
          "next": ["welcome_1"],
          "extra": {
            "hide_textbox": true
          }
        },
        "welcome_1": {
          "text": "So good to see you around again üòô",
          "next": "welcome_2",
          "extra": {
            "hide_textbox": true
          }
        },
        "welcome_2": {
          "text": "Please tell me, do you want to start the conversation again or continue right where you left it?",
          "buttons": [
            { "caption": "Start again", "event": "restart", "next": false },
            { "caption": "Continue", "event": "continue", "next": false }
          ],
          "extra": {
            "hide_textbox": true
          }
        }
      }
    }

    if ( window.CST_BACKUP ) {
      __data = welcomeBackBot;
    } else {
      __data = firstTimeBot;
    }

    window.jsbot = new ForaBotController();
    window.jsbot.on('output', forabotMessageReceived);
    window.jsbot.on('input', forabotMessageSent);
    window.jsbot.on('typing', forabotTypingState);
    window.jsbot.on('finish', function(){
      if (window.sendMessageBackup) {
        helloumi.webchat.umichatcore.sendMessage = window.sendMessageBackup;
        window.sendMessageBackup = false;
      }
      // $('#hu-container-widget').attr('data-textbox', 'show');
    });

    //
    // Custom events
    //
    window.jsbot.on('custom.clear', function(){
      $('#hu-webchat-messages').empty();
    });

    window.jsbot.on('custom.continue', function(){
      if ( window.CST_BACKUP ) {
        localStorage.setItem(window.STORAGE_KEY, window.CST_BACKUP);
      }
      helloumi.webchat.umichatcore.off('render', loadStaticWelcome) // Don't load this static welcome again
      loadHelloumiLiveChat();
    });

    window.jsbot.on('custom.restart', function(){
      if ( localStorage.getItem(window.STORAGE_KEY) ) {
        localStorage.removeItem(window.STORAGE_KEY)
        window.CST_BACKUP = null;
      }
      loadHelloumiLiveChat();
    });

    //
    // JsBot load
    //
    window.jsbot.load(
      new ForaBot(Date.now().toString(), __data )
    );

    if ( window.CST_BACKUP ) {
      window.sendMessageBackup = window.sendMessageBackup || helloumi.webchat.umichatcore.sendMessage;
      helloumi.webchat.umichatcore.sendMessage = function( formData ) {
        var __message = helloumi.webchat.umichatgui.container.querySelector('#hu-composer-box').value;
        window.jsbot.send(__message);
      };
    }

    window.jsbot.start();

    if ( window.CST_BACKUP ) {
      localStorage.setItem(window.STORAGE_KEY, window.CST_BACKUP);
    }
  }
</script>
<script src="https://storage.googleapis.com/static.yexir.com/landbot/js/landbot-1.0.0.js" onload="loadHelloumiLandbot()" charset="UTF-8"></script>
